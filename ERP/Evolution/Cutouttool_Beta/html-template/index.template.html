<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!--  BEGIN Browser History required section -->
<link rel="stylesheet" type="text/css" href="history/history.css" />
<!--  END Browser History required section -->

<title>${title}</title>
<script src="AC_OETags.js" language="javascript"></script>

<!--  BEGIN Browser History required section -->
<script src="history/history.js" language="javascript"></script>
<!--  END Browser History required section -->

<style>
body {	
				height: 100%;
				width: 100%;
				margin: 0;
				padding: 0;
				margin: 0px; 
				overflow:hidden;
				background-color: #000000;
			}
</style>
<script language="JavaScript" type="text/javascript">
//<!--
// -----------------------------------------------------------------------------
// Globals
// Major version of Flash required
var requiredMajorVersion = ${version_major};
// Minor version of Flash required
var requiredMinorVersion = ${version_minor};
// Minor version of Flash required
var requiredRevision = ${version_revision};
// -----------------------------------------------------------------------------
// -->

function getFlexApp(appName) {
  if (navigator.appName.indexOf ("Microsoft") !=-1) {
    return window[appName];
  } else {
    return document[appName];
  }
}

var txtFile;
var txtSize;
function FileNameDetails(sFile)
{
	//alert("ssss "+sFile);
	txtFile = escape(sFile);
	var filepathname = txtFile;
  	getFlexApp("CutOutTool").addFileNameDetails(filepathname);
}

function getUrl()
{
	var url = document.location.toString();
	return url;
}
function moveIFrame(x,y,w,h) {
	//alert("Move");
    var frameRef=document.getElementById("myFrame");
    frameRef.style.left=x;
    frameRef.style.top=y;
    var iFrameRef=document.getElementById("myIFrame");	
	iFrameRef.width=w;
	iFrameRef.height=h;
}

function hideIFrame(){
	//alert('Hidden');
    document.getElementById("myFrame").style.visibility="hidden";
}
	
function showIFrame(){
    //alert('Show'); 
    document.getElementById("myFrame").style.visibility="visible";
}

function loadIFrame(){			
	//document.getElementById("myFrame").innerHTML = "<iframe id='myIFrame' src='" + url + "'frameborder='0'></iframe>";
	document.getElementById("myFrame").innerHTML = "<applet id='myIFrame' code='DNDApplet.class' archive='DNDApplet.jar' mayscript='true' scriptable='true' width='200' height='200'><param name='funcNameHandleCurrentUpload' value='handleCurrentUpload'><param name='funcNameHandleFileNameDetails' value='FileNameDetails'><param name='funcAcceptBoolean' value='handleProgressStatus'><param name='uploadPath' value='appletupload.php'><param name='ImagePath' value='top.png'><param name='ColorName' value='#ffffff'></applet>";
}
var txtUpdone;
//File upload complete
function handleCurrentUpload( filenameStatus )
{
	//alert(filenameStatus);
	txtUpdone = escape(filenameStatus);
	var fileupDone = txtUpdone;
	
  	getFlexApp("CutOutTool").addUploadConfirmation(filenameStatus);
}
//All File upload complete
var txtbool;
function ConfirmationUpload(sFileConfirm)
{
	//alert(sFileConfirm);
	txtbool = escape(sFileConfirm);
	var fileupbool = txtbool;
  	//getFlexApp("CutOutTool").confirmationUpload(fileupbool);
}
//already upload progress
function handleProgressStatus ( str )
{
	//alert(str)
  	getFlexApp("CutOutTool").inProgressError(str);
}
//Flex to Applet communications
function flexHandlePurpose( boolStatus )
{
	//alert(boolStatus);
	document.getElementById('myIFrame').setEnabledStatus(boolStatus);
	
}
//-->
</script>
</head>
<body onload="loadIFrame();hideIFrame();" scroll='no'>
<script language="JavaScript" type="text/javascript">
//<!--
// Version check for the Flash Player that has the ability to start Player Product Install (6.0r65)
var hasProductInstall = DetectFlashVer(6, 0, 65);

// Version check based upon the values defined in globals
var hasRequestedVersion = DetectFlashVer(requiredMajorVersion, requiredMinorVersion, requiredRevision);

if ( hasProductInstall && !hasRequestedVersion ) {
	// DO NOT MODIFY THE FOLLOWING FOUR LINES
	// Location visited after installation is complete if installation is required
	var MMPlayerType = (isIE == true) ? "ActiveX" : "PlugIn";
	var MMredirectURL = window.location;
    document.title = document.title.slice(0, 47) + " - Flash Player Installation";
    var MMdoctitle = document.title;

	AC_FL_RunContent(
		"src", "playerProductInstall",
		"FlashVars", "MMredirectURL="+MMredirectURL+'&MMplayerType='+MMPlayerType+'&MMdoctitle='+MMdoctitle+"",
		"width", "${width}",
		"height", "${height}",
		"align", "middle",
		"id", "${application}",
		"quality", "high",
		"bgcolor", "${bgcolor}",
		"name", "${application}",
		"allowScriptAccess","sameDomain",
		"wmode", "transparent",
		"type", "application/x-shockwave-flash",
		"pluginspage", "http://www.adobe.com/go/getflashplayer"
	);
} else if (hasRequestedVersion) {
	// if we've detected an acceptable version
	// embed the Flash Content SWF when all tests are passed
	AC_FL_RunContent(
			"id", "${application}",
			"src", "${swf}",
			"width", "${width}",
			"height", "${height}",
			"quality", "high",
			"bgcolor", "${bgcolor}",
			"name", "${application}",
			"allowScriptAccess","sameDomain",
			"wmode", "transparent",
			"type", "application/x-shockwave-flash",
			"pluginspage", "http://www.adobe.com/go/getflashplayer"
	);
  }else {  // flash is too old or we can't detect the plugin
    var alternateContent = 'Alternate HTML content should be placed here. '
  	+ 'This content requires the Adobe Flash Player. '
   	+ '<a href=http://www.adobe.com/go/getflash/>Get Flash</a>';
    document.write(alternateContent);  // insert non-flash content
  } 
// -->
</script>
<div id="myFrame" style="position:absolute;background-color:transparent;"></div>
</body>
</html>

